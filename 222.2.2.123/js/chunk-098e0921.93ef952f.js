(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-098e0921","chunk-2d0d7882"],{"2ca8":function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Modal",{attrs:{title:"提交申请","mask-closable":!1,width:500},model:{value:e.applyModalVisible,callback:function(t){e.applyModalVisible=t},expression:"applyModalVisible"}},[s("Form",{ref:"form",attrs:{model:e.form,"label-width":85,rules:e.formValidate}},[s("FormItem",{attrs:{label:"标题",prop:"title"}},[s("Input",{attrs:{placeholder:"请输入标题",clearable:""},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:e.showAssign,expression:"showAssign"}],attrs:{label:"选择审批人",prop:"assignees",error:e.error}},[s("Select",{attrs:{placeholder:"请选择或输入搜索",filterable:"",clearable:"",multiple:"",loading:e.userLoading},model:{value:e.form.assignees,callback:function(t){e.$set(e.form,"assignees",t)},expression:"form.assignees"}},e._l(e.assigneeList,(function(t,n){return s("Option",{key:n,attrs:{value:t.id,label:t.nickname}},[s("span",{staticStyle:{"margin-right":"10px"}},[e._v(e._s(t.nickname))]),s("span",{staticStyle:{color:"#ccc"}},[e._v(e._s(t.username))])])})),1)],1),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:e.isCustom,expression:"isCustom"}],attrs:{label:"自定义搜索选择审批人",prop:"assignees",error:e.error}},[s("Select",{attrs:{placeholder:"请输入用户名搜索选择用户",filterable:"",remote:"",multiple:"","remote-method":e.searchUser,loading:e.userLoading},model:{value:e.form.assignees,callback:function(t){e.$set(e.form,"assignees",t)},expression:"form.assignees"}},e._l(e.userList,(function(t,n){return s("Option",{key:n,attrs:{value:t.id,label:t.nickname}},[s("span",{staticStyle:{"margin-right":"10px"}},[e._v(e._s(t.nickname))]),s("span",{staticStyle:{color:"#ccc"}},[e._v(e._s(t.username))])])})),1)],1),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:e.isGateway,expression:"isGateway"}],attrs:{label:"下一审批人"}},[s("span",[e._v("分支网关处暂不支持自定义选择下一审批人，将发送给下一节点所有人")])]),s("FormItem",{attrs:{label:"优先级",prop:"priority"}},[s("dict",{attrs:{dict:"priority"},model:{value:e.form.priority,callback:function(t){e.$set(e.form,"priority",t)},expression:"form.priority"}})],1),s("FormItem",{attrs:{label:"消息通知"}},[s("Checkbox",{model:{value:e.form.sendMessage,callback:function(t){e.$set(e.form,"sendMessage",t)},expression:"form.sendMessage"}},[e._v("站内消息通知")]),s("Checkbox",{model:{value:e.form.sendSms,callback:function(t){e.$set(e.form,"sendSms",t)},expression:"form.sendSms"}},[e._v("短信通知")]),s("Checkbox",{model:{value:e.form.sendEmail,callback:function(t){e.$set(e.form,"sendEmail",t)},expression:"form.sendEmail"}},[e._v("邮件通知")])],1)],1),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("Button",{attrs:{type:"text"},on:{click:function(t){e.applyModalVisible=!1}}},[e._v("取消")]),s("Button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:e.handelSubmit}},[e._v("提交")])],1)],1)],1)},a=[],i=s("81c1"),r=s("365c"),o=s("76e2"),l={name:"processStart",components:{dict:o["default"]},props:{value:{type:Boolean,default:!1},processKey:String,actBusinessId:String},data:function(){return{userLoading:!1,showAssign:!1,isGateway:!1,isCustom:!1,error:"",submitLoading:!1,applyModalVisible:this.value,form:{title:"",procDefId:"",assignees:[],priority:"0",sendMessage:!0,sendSms:!0,sendEmail:!0},formValidate:{title:[{required:!0,message:"不能为空",trigger:"change"}],priority:[{required:!0,message:"不能为空",trigger:"change"}]},assigneeList:[],routeName:"",userList:[]}},methods:{init:function(){},searchUser:function(e){var t=this;e&&(this.userLoading=!0,Object(r["fc"])(e).then((function(e){t.userLoading=!1,e.success&&(t.userList=e.result)})))},showApply:function(){var e=this;this.userLoading=!0,Object(i["b"])(this.form.procDefId).then((function(t){if(e.userLoading=!1,t.success){if(e.error="",3==t.result.type||4==t.result.type)return e.isGateway=!0,e.form.firstGateway=!0,e.showAssign=!1,void(e.isCustom=!1);if(5==t.result.type)return e.isCustom=!0,e.isGateway=!1,e.form.firstGateway=!1,void(e.showAssign=!1);if(1==t.result.type)if(e.showAssign=!0,e.isGateway=!1,e.form.firstGateway=!1,e.isCustom=!1,t.result.users&&t.result.users.length>0){e.assigneeList=t.result.users;var s=[];t.result.users.forEach((function(e){s.push(e.id)})),e.form.assignees=s,e.showAssign=!0}else e.form.assignees=[],e.showAssign=!0,e.error='请进入"流程管理"为审批节点分配候选审批人员'}})),this.applyModalVisible=!0},handelSubmit:function(){var e=this;this.$refs.form.validate((function(t){if(t){if((e.showAssign||e.isCustom)&&e.form.assignees.length<1)return void(e.error="请至少选择一个审批人");e.error="",e.submitLoading=!0,Object(i["g"])(e.form).then((function(t){e.submitLoading=!1,t.success&&(e.$Message.success("操作成功"),e.applyModalVisible=!1,e.$emit("on-submit",!0),e.routeName="")}))}}))},show:function(){var e=this;return this.processKey?this.actBusinessId?(this.form.id=this.actBusinessId,this.$emit("on-loading",!0),void Object(i["c"])(this.processKey).then((function(t){if(e.$emit("on-loaded",!1),t.success){if(!t.result)return e.$Message.error("未找到标识为 "+e.processKey+" 的流程"),void e.$emit("input",!1);if(!t.result.routeName)return e.$Message.warning("该流程信息未完善，请于流程管理中编辑流程完善信息"),void e.$emit("input",!1);e.routeName=t.result.routeName,e.form.procDefId=t.result.id,e.form.title=t.result.name,e.showApply()}}))):(this.$Message.error("请传入业务表ActBusiness的ID"),void this.$emit("input",!1)):(this.$Message.error("请先传入要申请的流程key"),void this.$emit("input",!1))},close:function(){this.applyModalVisible=!1}},watch:{value:function(e){1==e&&this.show()},applyModalVisible:function(e){this.$emit("input",e)}},mounted:function(){this.init()}},c=l,u=s("2877"),d=Object(u["a"])(c,n,a,!1,null,null,null);t["default"]=d.exports},"76e2":function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Select",{attrs:{size:e.size,loading:e.loading,placeholder:e.placeholder,multiple:e.multiple,disabled:e.disabled,filterable:e.filterable,transfer:e.transfer,clearable:e.clearable,placement:e.placement,"transfer-class-name":e.transferClassName,prefix:e.prefix,"max-tag-count":e.maxTagCount,"max-tag-placeholder":e.maxTagPlaceholder},on:{"on-change":e.handleChange,"on-query-change":e.handleQueryChange,"on-clear":e.handleClear,"on-open-change":e.handleOpenChange,"on-select":e.handleSelect},model:{value:e.currentValue,callback:function(t){e.currentValue=t},expression:"currentValue"}},e._l(e.dictData,(function(t,n){return s("Option",{key:n,attrs:{value:t.value}},[e._v(e._s(t.title))])})),1)],1)},a=[],i=s("365c"),r={name:"dict",props:{value:"",dict:String,placeholder:{type:String,default:"请选择"},placement:{type:String,default:"bottom-start"},size:String,multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},filterable:{type:Boolean,default:!1},transfer:{type:Boolean,default:!1},transferClassName:String,prefix:String,maxTagCount:Number,maxTagPlaceholder:Function,clearable:{type:Boolean,default:!0}},data:function(){return{currentValue:this.value,dictData:[],loading:!1}},methods:{getData:function(e){var t=this;this.loading=!0,Object(i["ib"])(e).then((function(e){t.loading=!1,e.success&&(t.dictData=e.result)}))},handleChange:function(e){this.$emit("input",e),this.$emit("on-change",e)},handleQueryChange:function(e){this.$emit("on-query-change",e)},handleClear:function(){this.$emit("on-clear","")},handleOpenChange:function(e){this.$emit("on-open-change",e)},handleSelect:function(e){this.$emit("on-select",e)},setCurrentValue:function(e){e!==this.currentValue&&(this.currentValue=e,this.$emit("on-change",this.currentValue))}},watch:{value:function(e){this.setCurrentValue(e)},dict:function(e){this.getData(e)}},mounted:function(){this.getData(this.dict)}},o=r,l=s("2877"),c=Object(l["a"])(o,n,a,!1,null,null,null);t["default"]=c.exports},"81c1":function(e,t,s){"use strict";s.d(t,"d",(function(){return a})),s.d(t,"c",(function(){return i})),s.d(t,"b",(function(){return r})),s.d(t,"e",(function(){return o})),s.d(t,"f",(function(){return l})),s.d(t,"g",(function(){return c})),s.d(t,"a",(function(){return u}));var n=s("7f80"),a=function(e){return Object(n["b"])("/actProcess/getByCondition",e)},i=function(e,t){return Object(n["b"])("/actProcess/getByKey/".concat(e),t)},r=function(e,t){return Object(n["b"])("/actProcess/getFirstNode/".concat(e),t)},o=function(e){return Object(n["b"])("/actCategory/getByParentId/0",e)},l=function(e,t){return Object(n["b"])("/actCategory/getByParentId/".concat(e),t)},c=function(e){return Object(n["e"])("/actBusiness/start",e)},u=function(e){return Object(n["e"])("/actBusiness/cancel",e)}}}]);