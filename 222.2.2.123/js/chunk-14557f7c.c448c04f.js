(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-14557f7c","chunk-1b72bbde","chunk-2d0bd650","chunk-2d0d7882"],{"2c8a":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Cascader",{attrs:{data:e.department,"load-data":e.loadData,"change-on-select":"",size:e.size,transfer:e.transfer,"transfer-class-name":e.transferClassName,disabled:e.disabled,filterable:e.filterable,clearable:e.clearable,placeholder:e.placeholder},on:{"on-change":e.handleChangeDep,"on-visible-change":e.handleVisibleChange},model:{value:e.selectDep,callback:function(t){e.selectDep=t},expression:"selectDep"}})],1)},n=[],r=a("365c"),i={name:"departmentChoose",props:{size:String,transfer:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},filterable:{type:Boolean,default:!0},clearable:{type:Boolean,default:!0},placeholder:{type:String,default:"请选择或输入搜索部门"},transferClassName:String},data:function(){return{selectDep:[],department:[]}},methods:{initDepartmentData:function(){var e=this;Object(r["Mb"])().then((function(t){t.success&&(t.result.forEach((function(e){e.isParent?(e.value=e.id,e.label=e.title,e.loading=!1,e.children=[]):(e.value=e.id,e.label=e.title),-1==e.status&&(e.label="[已禁用] "+e.label,e.disabled=!0)})),e.department=t.result)}))},loadData:function(e,t){e.loading=!0,Object(r["Ob"])(e.value).then((function(a){e.loading=!1,a.success&&(a.result.forEach((function(e){e.isParent?(e.value=e.id,e.label=e.title,e.loading=!1,e.children=[]):(e.value=e.id,e.label=e.title),-1==e.status&&(e.label="[已禁用] "+e.label,e.disabled=!0)})),e.children=a.result,t())}))},handleChangeDep:function(e,t){var a="";e&&e.length>0&&(a=e[e.length-1]),this.$emit("on-change",a)},handleVisibleChange:function(e){this.$emit("on-visible-change",e)},clearSelect:function(){this.selectDep=[],this.$emit("on-change","")}},mounted:function(){this.initDepartmentData()}},l=i,o=a("2877"),c=Object(o["a"])(l,s,n,!1,null,null,null);t["default"]=c.exports},"5e40":function(e,t,a){"use strict";a("d01b")},"5e64":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user-choose"},[a("Button",{attrs:{size:e.size,type:e.type,shape:e.shape,icon:e.icon},on:{click:function(t){e.userModalVisible=!0}}},[e._v(e._s(e.text))]),a("span",{directives:[{name:"show",rawName:"v-show",value:e.showClear&&e.selectUsers.length>0,expression:"showClear && selectUsers.length > 0"}],staticClass:"clear",on:{click:e.clearData}},[e._v("清空已选")]),a("Collapse",{staticClass:"collapse",attrs:{simple:""}},[a("Panel",{attrs:{name:"1"}},[e._v(" 已选择 "),a("span",{staticClass:"select-count"},[e._v(e._s(e.selectUsers.length))]),e._v(" 人 "),a("p",{attrs:{slot:"content"},slot:"content"},e._l(e.selectUsers,(function(t,s){return a("Tag",{key:s,attrs:{name:t.id,color:"default",closable:""},on:{"on-close":e.handleCancelUser}},[a("Tooltip",{attrs:{placement:"top",content:t.username}},[e._v(e._s(t.nickname))])],1)})),1)])],1),a("Drawer",{staticClass:"user-choose-drawer",attrs:{title:"选择用户",closable:"",width:"815",draggable:"",transfer:e.transfer,"mask-style":e.maskStyle,"class-name":e.className},model:{value:e.userModalVisible,callback:function(t){e.userModalVisible=t},expression:"userModalVisible"}},[a("Form",{ref:"searchForm",attrs:{model:e.searchForm,inline:"","label-width":70}},[a("FormItem",{attrs:{label:"用户名",prop:"nickname"}},[a("Input",{staticStyle:{width:"180px"},attrs:{type:"text",clearable:"",placeholder:"请输入用户名"},model:{value:e.searchForm.nickname,callback:function(t){e.$set(e.searchForm,"nickname",t)},expression:"searchForm.nickname"}})],1),a("FormItem",{attrs:{label:"部门",prop:"department"}},[a("department-choose",{ref:"dep",staticStyle:{width:"180px"},on:{"on-change":e.handleSelectDep}})],1),e.drop?a("span",[a("FormItem",{attrs:{label:"手机号",prop:"mobile"}},[a("Input",{staticStyle:{width:"180px"},attrs:{type:"text",clearable:"",placeholder:"请输入手机号"},model:{value:e.searchForm.mobile,callback:function(t){e.$set(e.searchForm,"mobile",t)},expression:"searchForm.mobile"}})],1),a("FormItem",{attrs:{label:"邮箱",prop:"email"}},[a("Input",{staticStyle:{width:"180px"},attrs:{type:"text",clearable:"",placeholder:"请输入邮箱"},model:{value:e.searchForm.email,callback:function(t){e.$set(e.searchForm,"email",t)},expression:"searchForm.email"}})],1),a("FormItem",{attrs:{label:"性别",prop:"sex"}},[a("dict",{staticStyle:{width:"180px"},attrs:{dict:"sex"},model:{value:e.searchForm.sex,callback:function(t){e.$set(e.searchForm,"sex",t)},expression:"searchForm.sex"}})],1),a("FormItem",{attrs:{label:"登录账号",prop:"username"}},[a("Input",{staticStyle:{width:"180px"},attrs:{type:"text",clearable:"",placeholder:"请输入登录账号"},model:{value:e.searchForm.username,callback:function(t){e.$set(e.searchForm,"username",t)},expression:"searchForm.username"}})],1),a("FormItem",{attrs:{label:"用户ID",prop:"id"}},[a("Input",{staticStyle:{width:"180px"},attrs:{type:"text",clearable:"",placeholder:"请输入用户ID"},model:{value:e.searchForm.id,callback:function(t){e.$set(e.searchForm,"id",t)},expression:"searchForm.id"}})],1)],1):e._e(),a("FormItem",{staticClass:"br",staticStyle:{"margin-left":"-35px"}},[a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:e.handleSearchUser}},[e._v("搜索")]),a("Button",{on:{click:e.handleResetUser}},[e._v("重置")]),a("a",{staticClass:"drop-down",on:{click:e.dropDown}},[e._v(" "+e._s(e.dropDownContent)+" "),a("Icon",{attrs:{type:e.dropDownIcon}})],1)],1)],1),a("Alert",{attrs:{"show-icon":""}},[e._v(" 已选择 "),a("span",{staticClass:"select-count"},[e._v(e._s(e.selectUsers.length))]),e._v(" 项 "),a("a",{staticStyle:{"margin-left":"10px"},on:{click:e.clearData}},[e._v("清空已选")])]),a("Table",{staticStyle:{margin:"2vh 0"},attrs:{loading:e.userLoading,border:"",columns:e.userColumns,data:e.userData}}),a("Row",{attrs:{type:"flex",justify:"end"}},[a("Page",{attrs:{current:e.searchForm.pageNumber,total:e.totalUser,"page-size":e.searchForm.pageSize,"page-size-opts":[10,20,50],size:"small","show-total":"","show-elevator":"","show-sizer":"",transfer:""},on:{"on-change":e.changePage,"on-page-size-change":e.changePageSize}})],1)],1)],1)},n=[],r=a("365c"),i=a("2c8a"),l=a("76e2"),o={name:"userChoose",components:{departmentChoose:i["default"],dict:l["default"]},props:{value:{type:Array,default:[]},text:{type:String,default:"选择用户"},icon:{type:String,default:"md-person-add"},showClear:{type:Boolean,default:!0},size:String,type:String,shape:String,transfer:{type:Boolean,default:!0},maskStyle:Object,className:Object},data:function(){var e=this;return{userLoading:!0,userModalVisible:!1,drop:!1,dropDownContent:"展开",dropDownIcon:"ios-arrow-down",selectUsers:this.value,searchForm:{id:"",nickname:"",type:"",status:"",pageNumber:1,pageSize:10,sort:"createTime",order:"desc"},userColumns:[{type:"index",width:60,align:"center"},{title:"用户名",key:"nickname",minWidth:130,sortable:!0},{title:"登录账号",key:"username",minWidth:130,sortable:!0},{title:"头像",key:"avatar",width:80,align:"center",render:function(e,t){return e("Avatar",{props:{src:t.row.avatar}})}},{title:"所属部门",key:"departmentTitle",width:120},{title:"手机",key:"mobile",width:125,sortable:!0},{title:"邮箱",key:"email",width:180,sortable:!0},{title:"性别",key:"sex",width:70,align:"center"},{title:"创建时间",key:"createTime",sortable:!0,sortType:"desc",width:170},{title:"操作",key:"action",width:130,align:"center",fixed:"right",render:function(t,a){return t("div",[t("Button",{props:{type:"info",size:"small"},on:{click:function(){e.chooseUser(a.row)}}},"添加该用户")])}}],userData:[],totalUser:0}},methods:{handleSelectDep:function(e){this.searchForm.departmentId=e},dropDown:function(){this.drop?(this.dropDownContent="展开",this.dropDownIcon="ios-arrow-down"):(this.dropDownContent="收起",this.dropDownIcon="ios-arrow-up"),this.drop=!this.drop},changePage:function(e){this.searchForm.pageNumber=e,this.getDataList()},changePageSize:function(e){this.searchForm.pageSize=e,this.getDataList()},getDataList:function(){var e=this;this.userLoading=!0,Object(r["Hb"])(this.searchForm).then((function(t){e.userLoading=!1,t.success&&(e.userData=t.result.content,e.totalUser=t.result.totalElements)}))},handleSearchUser:function(){this.searchForm.pageNumber=1,this.searchForm.pageSize=10,this.getDataList()},handleResetUser:function(){this.$refs.searchForm.resetFields(),this.searchForm.pageNumber=1,this.searchForm.pageSize=10,this.$refs.dep.clearSelect(),this.searchForm.departmentId="",this.getDataList()},setData:function(e){this.selectUsers=e,this.$emit("on-change",this.selectUsers),this.$emit("input",this.selectUsers)},chooseUser:function(e){var t=this,a=!0;if(this.selectUsers.forEach((function(s){e.id==s.id&&(t.$Message.warning("已经添加过啦，请勿重复选择"),a=!1)})),a){var s={id:e.id,username:e.username,nickname:e.nickname};this.selectUsers.push(s),this.$emit("on-change",this.selectUsers),this.$emit("input",this.selectUsers),this.$Message.success("添加用户 ".concat(e.nickname," 成功"))}},clearData:function(){this.selectUsers=[],this.$emit("on-change",this.selectUsers),this.$emit("input",this.selectUsers)},handleCancelUser:function(e,t){this.selectUsers=this.selectUsers.filter((function(e){return e.id!=t})),this.$emit("on-change",this.selectUsers),this.$emit("input",this.selectUsers),this.$Message.success("删除所选用户成功")},setCurrentValue:function(e){e!==this.selectUsers&&(this.selectUsers=e)}},watch:{value:function(e){this.setCurrentValue(e)}},mounted:function(){this.getDataList()}},c=o,u=(a("b3fa"),a("2877")),d=Object(u["a"])(c,s,n,!1,null,null,null);t["default"]=d.exports},"6b62":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Card",[a("div",{attrs:{slot:"title"},slot:"title"},[a("div",{staticClass:"edit-head"},[a("a",{staticClass:"back-title",on:{click:e.close}},[a("Icon",{attrs:{type:"ios-arrow-back"}}),e._v("返回 ")],1),a("div",{staticClass:"head-name"},[e._v(" "+e._s(e.title)+" ")]),a("span"),a("a",{staticClass:"window-close",on:{click:e.close}},[a("Icon",{staticClass:"ivu-icon-ios-close",attrs:{type:"ios-close",size:"31"}})],1)])]),a("Form",{ref:"form",staticStyle:{position:"relative"},attrs:{model:e.form,"label-width":90,rules:e.formValidate}},[a("FormItem",{directives:[{name:"show",rawName:"v-show",value:1==e.type,expression:"type == 1"}],attrs:{label:"消息ID：",prop:"id"}},[e._v(" "+e._s(e.form.id)+" ")]),a("FormItem",{attrs:{label:"消息类型",prop:"type"}},[a("dict",{staticStyle:{width:"300px"},attrs:{dict:"message_type"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}})],1),a("FormItem",{attrs:{label:"标题",prop:"title"}},[a("Input",{staticStyle:{width:"600px"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),a("FormItem",{directives:[{name:"show",rawName:"v-show",value:e.form.isTemplate,expression:"form.isTemplate"}],staticStyle:{"margin-bottom":"5px"}},[a("Alert",{attrs:{"show-icon":""}},[e._v("消息模版变量格式：${变量名}【标题及内容都支持】 示例：您的验证码为：${code}，该验证码5分钟内有效，请勿泄漏于他人 "),a("a",{attrs:{href:"https://www.kancloud.cn/zwz/xboot/1021404",target:"_blank"}},[e._v("详见开发文档")])])],1),a("FormItem",{attrs:{label:"内容",prop:"content"}},[a("editor",{attrs:{height:"250"},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),a("FormItem",{attrs:{label:"新创建的账号也推送",prop:"createSend"}},[a("i-switch",{attrs:{size:"large"},model:{value:e.form.createSend,callback:function(t){e.$set(e.form,"createSend",t)},expression:"form.createSend"}},[a("span",{attrs:{slot:"open"},slot:"open"},[e._v("开启")]),a("span",{attrs:{slot:"close"},slot:"close"},[e._v("关闭")])])],1),0==e.type?a("div",[a("FormItem",{attrs:{label:"发送范围"}},[a("RadioGroup",{model:{value:e.form.range,callback:function(t){e.$set(e.form,"range",t)},expression:"form.range"}},[a("Radio",{attrs:{label:0,border:""}},[e._v("全体用户")]),a("Radio",{attrs:{label:1,border:""}},[e._v("指定用户成员")])],1)],1),a("div",[1==e.form.range?a("FormItem",{attrs:{label:"选择用户"}},[a("user-choose",{attrs:{text:"选择发送用户"},model:{value:e.selectUsers,callback:function(t){e.selectUsers=t},expression:"selectUsers"}})],1):e._e()],1)],1):e._e(),a("FormItem",{staticClass:"br"},[a("Button",{staticStyle:{width:"100px"},attrs:{type:"primary",loading:e.submitLoading},on:{click:e.handelSubmit}},[e._v("提交")]),a("Button",{on:{click:e.close}},[e._v("取消")])],1),e.loading?a("Spin",{attrs:{size:"large",fix:""}}):e._e()],1)],1)],1)},n=[],r=a("365c"),i=a("ee24"),l=a("5e64"),o=a("76e2"),c={name:"add_edit_message",components:{userChoose:l["default"],editor:i["default"],dict:o["default"]},props:{transferData:Object},data:function(){return{type:0,title:"",loading:!1,selectUsers:[],userModalVisible:!1,modalTitle:"",form:{title:"",content:"",type:"",range:0,createSend:!1,isTemplate:!1},formValidate:{type:[{required:!0,message:"消息类型不能为空",trigger:"change"}],title:[{required:!0,message:"标题不能为空",trigger:"change"}],content:[{required:!0,message:"内容不能为空",trigger:"change"}]},submitLoading:!1,backRoute:""}},methods:{init:function(){this.type=this.transferData.type,1==this.type?(this.title="编辑消息",this.form.id=this.transferData.id,this.getData()):0==this.type?(this.title="发送新消息",this.selectUsers=[]):-1==this.type&&(this.title="添加系统模版消息",this.selectUsers=[],this.form.isTemplate=!0,this.form.range=-1)},getData:function(){var e=this;this.loading=!0,Object(r["qb"])(this.form.id).then((function(t){if(e.loading=!1,t.success){var a=t.result;for(var s in a)null==a[s]&&(a[s]="");var n=JSON.stringify(a),r=JSON.parse(n);e.form=r}}))},handelSubmit:function(){var e=this;this.$refs.form.validate((function(t){if(t)if(e.submitLoading=!0,0==e.type){delete e.form.id;var a=[];e.selectUsers.forEach((function(e){a+=e.id+","})),a.length>0&&(a=a.substring(0,a.length-1)),e.form.userIds=a,Object(r["d"])(e.form).then((function(t){e.submitLoading=!1,t.success&&(e.$Message.success("操作成功"),e.submited())}))}else 1==e.type?Object(r["M"])(e.form).then((function(t){e.submitLoading=!1,t.success&&(e.$Message.success("操作成功"),e.submited())})):Object(r["d"])(e.form).then((function(t){e.submitLoading=!1,t.success&&(e.$Message.success("操作成功"),e.submited())}))}))},close:function(){this.$emit("close",!0)},submited:function(){this.$emit("submited",!0)}},mounted:function(){this.init()}},u=c,d=(a("5e40"),a("2877")),h=Object(d["a"])(u,s,n,!1,null,null,null);t["default"]=h.exports},"76e2":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Select",{attrs:{size:e.size,loading:e.loading,placeholder:e.placeholder,multiple:e.multiple,disabled:e.disabled,filterable:e.filterable,transfer:e.transfer,clearable:e.clearable,placement:e.placement,"transfer-class-name":e.transferClassName,prefix:e.prefix,"max-tag-count":e.maxTagCount,"max-tag-placeholder":e.maxTagPlaceholder},on:{"on-change":e.handleChange,"on-query-change":e.handleQueryChange,"on-clear":e.handleClear,"on-open-change":e.handleOpenChange,"on-select":e.handleSelect},model:{value:e.currentValue,callback:function(t){e.currentValue=t},expression:"currentValue"}},e._l(e.dictData,(function(t,s){return a("Option",{key:s,attrs:{value:t.value}},[e._v(e._s(t.title))])})),1)],1)},n=[],r=a("365c"),i={name:"dict",props:{value:"",dict:String,placeholder:{type:String,default:"请选择"},placement:{type:String,default:"bottom-start"},size:String,multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},filterable:{type:Boolean,default:!1},transfer:{type:Boolean,default:!1},transferClassName:String,prefix:String,maxTagCount:Number,maxTagPlaceholder:Function,clearable:{type:Boolean,default:!0}},data:function(){return{currentValue:this.value,dictData:[],loading:!1}},methods:{getData:function(e){var t=this;this.loading=!0,Object(r["ib"])(e).then((function(e){t.loading=!1,e.success&&(t.dictData=e.result)}))},handleChange:function(e){this.$emit("input",e),this.$emit("on-change",e)},handleQueryChange:function(e){this.$emit("on-query-change",e)},handleClear:function(){this.$emit("on-clear","")},handleOpenChange:function(e){this.$emit("on-open-change",e)},handleSelect:function(e){this.$emit("on-select",e)},setCurrentValue:function(e){e!==this.currentValue&&(this.currentValue=e,this.$emit("on-change",this.currentValue))}},watch:{value:function(e){this.setCurrentValue(e)},dict:function(e){this.getData(e)}},mounted:function(){this.getData(this.dict)}},l=i,o=a("2877"),c=Object(o["a"])(l,s,n,!1,null,null,null);t["default"]=c.exports},"8c16":function(e,t,a){},b3fa:function(e,t,a){"use strict";a("8c16")},d01b:function(e,t,a){}}]);