(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c876586c","chunk-2d0d7882"],{"00c0":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{display:"flex",position:"relative"}},[s("Form",{ref:"ossForm",attrs:{model:e.oss,"label-width":110,"label-position":"left",rules:e.ossValidate}},[s("FormItem",{attrs:{label:"服务提供商",prop:"serviceName"}},[s("Select",{staticStyle:{width:"230px"},attrs:{placeholder:"请选择"},on:{"on-change":e.changeOss},model:{value:e.oss.serviceName,callback:function(t){e.$set(e.oss,"serviceName",t)},expression:"oss.serviceName"}},[s("Option",{attrs:{value:"LOCAL_OSS"}},[e._v("本地服务器")]),s("Option",{attrs:{value:"MINIO_OSS"}},[e._v("MinIO")]),s("Option",{attrs:{value:"QINIU_OSS"}},[e._v("七牛云")]),s("Option",{attrs:{value:"ALI_OSS"}},[e._v("阿里云")]),s("Option",{attrs:{value:"TENCENT_OSS"}},[e._v("腾讯云")])],1)],1),"LOCAL_OSS"!=e.oss.serviceName?s("div",[s("FormItem",{attrs:{label:"accessKey",prop:"accessKey"}},[s("Input",{staticStyle:{width:"380px"},attrs:{type:"text",placeholder:"请输入accessKey/secretId",disabled:e.changeLoading},model:{value:e.oss.accessKey,callback:function(t){e.$set(e.oss,"accessKey",t)},expression:"oss.accessKey"}})],1),s("FormItem",{attrs:{label:"secretKey",prop:"secretKey"}},[s("Tooltip",{attrs:{placement:"right",content:"无法编辑时请先点击查看图标"}},[s("Input",{staticClass:"input-see",staticStyle:{width:"380px"},attrs:{type:"text",disabled:e.changeLoading,readonly:!e.changedOssSK,icon:"ios-eye",placeholder:"请输入secretKey"},on:{"on-click":function(t){return e.seeSecret(e.oss.serviceName)}},model:{value:e.oss.secretKey,callback:function(t){e.$set(e.oss,"secretKey",t)},expression:"oss.secretKey"}})],1)],1),"QINIU_OSS"==e.oss.serviceName?s("FormItem",{attrs:{label:"zone存储区域",prop:"zone"}},[s("Select",{staticStyle:{width:"380px"},attrs:{placeholder:"请选择存储区域",disabled:e.changeLoading},model:{value:e.oss.zone,callback:function(t){e.$set(e.oss,"zone",t)},expression:"oss.zone"}},[s("Option",{attrs:{value:-1}},[e._v("自动判断")]),s("Option",{attrs:{value:0}},[e._v("华东")]),s("Option",{attrs:{value:1}},[e._v("华北")]),s("Option",{attrs:{value:2}},[e._v("华南")]),s("Option",{attrs:{value:3}},[e._v("北美")]),s("Option",{attrs:{value:4}},[e._v("东南亚")])],1)],1):e._e(),s("FormItem",{attrs:{label:"bucket空间",prop:"bucket"}},[s("Input",{staticStyle:{width:"380px"},attrs:{type:"text",placeholder:"请输入bucket空间名",disabled:e.changeLoading},model:{value:e.oss.bucket,callback:function(t){e.$set(e.oss,"bucket",t)},expression:"oss.bucket"}})],1),"TENCENT_OSS"==e.oss.serviceName?s("FormItem",{attrs:{label:"所属地域",prop:"bucketRegion"}},[s("dict",{attrs:{dict:"tencent_bucket_region",placeholder:"请选择或输入搜索",filterable:"",disabled:e.changeLoading,transfer:""},model:{value:e.oss.bucketRegion,callback:function(t){e.$set(e.oss,"bucketRegion",t)},expression:"oss.bucketRegion"}})],1):e._e(),s("FormItem",{attrs:{label:"endpoint域名",prop:"endpoint",error:e.errorMsg}},[s("Input",{staticStyle:{width:"380px"},attrs:{type:"text",placeholder:e.endpointPH,disabled:e.changeLoading},model:{value:e.oss.endpoint,callback:function(t){e.$set(e.oss,"endpoint",t)},expression:"oss.endpoint"}},[s("Select",{staticStyle:{width:"80px"},attrs:{slot:"prepend",prop:"http"},slot:"prepend",model:{value:e.oss.http,callback:function(t){e.$set(e.oss,"http",t)},expression:"oss.http"}},[s("Option",{attrs:{value:"http://"}},[e._v("http://")]),s("Option",{attrs:{value:"https://"}},[e._v("https://")])],1)],1)],1)],1):s("div",[s("FormItem",{attrs:{label:"存储磁盘路径",prop:"filePath",error:e.errorMsg2}},[s("Input",{staticStyle:{width:"380px"},attrs:{type:"text",placeholder:"例如D:/upload",disabled:e.changeLoading},model:{value:e.oss.filePath,callback:function(t){e.$set(e.oss,"filePath",t)},expression:"oss.filePath"}})],1),s("FormItem",{attrs:{label:"文件预览接口",prop:"endpoint",error:e.errorMsg}},[s("Input",{staticStyle:{width:"380px"},attrs:{type:"text",placeholder:"请输入文件预览接口"},model:{value:e.oss.endpoint,callback:function(t){e.$set(e.oss,"endpoint",t)},expression:"oss.endpoint"}},[s("Select",{staticStyle:{width:"80px"},attrs:{slot:"prepend",prop:"http",disabled:e.changeLoading},slot:"prepend",model:{value:e.oss.http,callback:function(t){e.$set(e.oss,"http",t)},expression:"oss.http"}},[s("Option",{attrs:{value:"http://"}},[e._v("http://")]),s("Option",{attrs:{value:"https://"}},[e._v("https://")])],1)],1)],1)],1),s("FormItem",[s("Button",{staticStyle:{width:"100px"},attrs:{type:"primary",disabled:e.changeLoading,loading:e.saveLoading},on:{click:e.saveEditOss}},[e._v("保存并启用")])],1)],1),e.loading?s("Spin",{attrs:{fix:""}}):e._e()],1)},n=[],i=s("365c"),o=s("76e2"),r={name:"oss",components:{dict:o["default"]},data:function(){return{loading:!1,changeLoading:!1,saveLoading:!1,errorMsg:"",errorMsg2:"",oss:{serviceName:"",accessKey:"",secretKey:"",endpoint:"",bucket:"",bucketRegion:"",zone:null},changedOssSK:!1,ossValidate:{serviceName:[{required:!0,message:"请选择",trigger:"change"}],accessKey:[{required:!0,message:"不能为空",trigger:"blur"}],secretKey:[{required:!0,message:"不能为空",trigger:"blur"}],endpoint:[{required:!0,message:"不能为空",trigger:"blur"}],bucket:[{required:!0,message:"不能为空",trigger:"blur"}],zone:[{required:!0,type:"number",message:"不能为空",trigger:"change"}],bucketRegion:[{required:!0,message:"不能为空",trigger:"change"}]},endpointPH:"请输入空间访问域名"}},methods:{init:function(){this.initOssSet()},initOssSet:function(){var e=this;this.loading=!0,Object(i["m"])().then((function(t){if(t.success&&t.result){var s=t.result;Object(i["ub"])(s).then((function(t){if(e.loading=!1,t.result){for(var s in t.result)null==t.result[s]&&(t.result[s]="");e.oss=t.result}else e.changedOssSK=!0}))}else e.loading=!1,e.changedOssSK=!0}))},changeOss:function(e){var t=this;this.endpointPH="ALI_OSS"==e?"请输入EndPoint(地域节点) 非Bucket域名":"TENCENT_OSS"==e?"请输入完整请求域名":"请输入空间访问域名",this.changeLoading=!0,Object(i["ub"])(e).then((function(s){if(t.changeLoading=!1,s.result){for(var a in s.result)null==s.result[a]&&(s.result[a]="");t.oss=s.result,t.changedOssSK=!1}else t.oss={serviceName:e},"LOCAL_OSS"==t.oss.serviceName&&(t.oss.http="http://",t.oss.endpoint="127.0.0.1:9999/zwz/file/view"),t.changedOssSK=!0}))},seeSecret:function(e){var t=this;e&&Object(i["gc"])(e).then((function(e){e.success&&(t.oss.secretKey=e.result,t.changedOssSK=!0)}))},saveEditOss:function(){var e=this;if("LOCAL_OSS"==this.oss.serviceName){if(!this.oss.http)return void(this.errorMsg="请选择http协议");if(this.errorMsg="",!this.oss.endpoint)return void(this.errorMsg="请输入文件预览接口");if(this.errorMsg="",!this.oss.filePath)return void(this.errorMsg2="请输入存储磁盘路径");this.errorMsg2="",Object(i["P"])(this.oss).then((function(t){e.saveLoading=!1,t.success&&e.$Message.success("保存成功")}))}else this.$refs.ossForm.validate((function(t){if(t){if(!e.oss.http)return void(e.errorMsg="请选择http协议");e.errorMsg="",e.saveLoading=!0,e.oss.changed=e.changedOssSK,Object(i["P"])(e.oss).then((function(t){e.saveLoading=!1,t.success&&e.$Message.success("保存成功")}))}}))}},mounted:function(){this.init()}},l=r,c=s("2877"),u=Object(c["a"])(l,a,n,!1,null,null,null);t["default"]=u.exports},"76e2":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Select",{attrs:{size:e.size,loading:e.loading,placeholder:e.placeholder,multiple:e.multiple,disabled:e.disabled,filterable:e.filterable,transfer:e.transfer,clearable:e.clearable,placement:e.placement,"transfer-class-name":e.transferClassName,prefix:e.prefix,"max-tag-count":e.maxTagCount,"max-tag-placeholder":e.maxTagPlaceholder},on:{"on-change":e.handleChange,"on-query-change":e.handleQueryChange,"on-clear":e.handleClear,"on-open-change":e.handleOpenChange,"on-select":e.handleSelect},model:{value:e.currentValue,callback:function(t){e.currentValue=t},expression:"currentValue"}},e._l(e.dictData,(function(t,a){return s("Option",{key:a,attrs:{value:t.value}},[e._v(e._s(t.title))])})),1)],1)},n=[],i=s("365c"),o={name:"dict",props:{value:"",dict:String,placeholder:{type:String,default:"请选择"},placement:{type:String,default:"bottom-start"},size:String,multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},filterable:{type:Boolean,default:!1},transfer:{type:Boolean,default:!1},transferClassName:String,prefix:String,maxTagCount:Number,maxTagPlaceholder:Function,clearable:{type:Boolean,default:!0}},data:function(){return{currentValue:this.value,dictData:[],loading:!1}},methods:{getData:function(e){var t=this;this.loading=!0,Object(i["ib"])(e).then((function(e){t.loading=!1,e.success&&(t.dictData=e.result)}))},handleChange:function(e){this.$emit("input",e),this.$emit("on-change",e)},handleQueryChange:function(e){this.$emit("on-query-change",e)},handleClear:function(){this.$emit("on-clear","")},handleOpenChange:function(e){this.$emit("on-open-change",e)},handleSelect:function(e){this.$emit("on-select",e)},setCurrentValue:function(e){e!==this.currentValue&&(this.currentValue=e,this.$emit("on-change",this.currentValue))}},watch:{value:function(e){this.setCurrentValue(e)},dict:function(e){this.getData(e)}},mounted:function(){this.getData(this.dict)}},r=o,l=s("2877"),c=Object(l["a"])(r,a,n,!1,null,null,null);t["default"]=c.exports}}]);