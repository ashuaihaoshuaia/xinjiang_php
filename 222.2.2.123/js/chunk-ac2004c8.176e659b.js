(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ac2004c8","chunk-688e6f79","chunk-8cb1c234","chunk-1c49fd68"],{3988:function(t,e,s){},"3e05":function(t,e,s){},"5c11":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"authorize"},[a("Row",{staticStyle:{height:"100%"},attrs:{type:"flex",justify:"center",align:"middle"},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit.apply(null,arguments)}}},[a("Col",{staticClass:"content",style:{width:t.userInfo?"450px":"390px"}},[a("div",[a("div",{staticClass:"logos-wrap"},[a("div",{staticClass:"logos"},[a("Avatar",{staticClass:"top site-logo",style:{background:"#fff"},attrs:{src:t.site.logo,size:"96"}}),a("Icon",{staticClass:"top",attrs:{type:"ios-checkmark-circle",color:"#52c41a",size:"32"}}),a("Avatar",{staticClass:"top",style:{background:"#f1f2f5"},attrs:{src:s("d1e0"),size:"96"}}),a("div",{staticClass:"line"})],1),a("div",{staticClass:"auth-title"},[t._v(t._s(t.$t("authorize"))+" "+t._s(t.site.name))])]),t.error||t.authLoading||t.userInfo?t._e():a("div",[a("Tabs",{attrs:{value:"1"}},[a("TabPane",{attrs:{label:t.$t("sso"),name:"1",icon:"md-people"}},[a("Form",{ref:"loginForm",staticClass:"form",attrs:{model:t.form,rules:t.rules}},[a("FormItem",{attrs:{prop:"username"}},[a("Input",{attrs:{prefix:"ios-contact",size:"large",clearable:"",placeholder:"账号/邮箱/手机号",autocomplete:"off"},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}})],1),a("FormItem",{attrs:{prop:"password"}},[a("Input",{attrs:{type:"password",prefix:"ios-lock",size:"large",clearable:"",placeholder:"请输入密码",autocomplete:"off"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),a("FormItem",{attrs:{prop:"code"}},[a("Row",{staticStyle:{"align-items":"center",overflow:"hidden"},attrs:{type:"flex",justify:"space-between"}},[a("Input",{staticStyle:{width:"67%"},attrs:{size:"large",clearable:"",placeholder:"请输入图片验证码",maxlength:10},model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}}),a("div",{staticClass:"code-image",staticStyle:{position:"relative","font-size":"12px"}},[t.loadingCaptcha?a("Spin",{attrs:{fix:""}}):t._e(),a("img",{staticStyle:{width:"110px",cursor:"pointer",display:"block"},attrs:{src:t.captchaImg,alt:"加载验证码失败"},on:{click:t.getCaptchaImg}})],1)],1)],1)],1)],1)],1),a("Row",[a("Button",{attrs:{type:"primary",size:"large",loading:t.loading,long:""},on:{click:t.submit}},[t.loading?a("span",[t._v(t._s(t.$t("authorizing")))]):a("span",[t._v(t._s(t.$t("authorizeAndSignin")))])])],1),a("Row",{staticClass:"other-thing",attrs:{type:"flex",justify:"space-between"}},[a("router-link",{staticClass:"back",attrs:{to:"/reset"}},[t._v(t._s(t.$t("forgetPass")))]),a("router-link",{staticClass:"back",attrs:{to:"/regist"}},[t._v(" "+t._s(t.$t("registerNow"))+" ")])],1)],1),t.error||t.authLoading||!t.userInfo?t._e():a("div",[t.error?t._e():a("Card",{attrs:{"dis-hover":"",padding:0}},[a("div",{staticClass:"auth-card"},[a("div",{staticClass:"auth-info-wrap"},[a("div",{staticClass:"auth-detail",staticStyle:{"margin-bottom":"25px"}},[a("Avatar",{staticClass:"auth-pic",style:{background:"#fff"},attrs:{src:t.userInfo.avatar,size:"40"}}),a("div",[a("a",{staticClass:"auth-detail-href",attrs:{href:t.site.homeUri,target:"_blank"}},[t._v(t._s(t.site.name))]),a("div",{staticClass:"auth-detail-sub-title"},[t._v(" "+t._s(t.$t("wants"))+" "),a("span",{staticClass:"auth-detail-strong"},[t._v(t._s(t.userInfo.username))]),t._v(" "+t._s(t.$t("wants2"))+" ")])])],1),a("div",{staticClass:"auth-detail",staticStyle:{"margin-bottom":"15px"}},[a("Icon",{staticClass:"auth-pic",attrs:{type:"md-person",color:"#6a737d",size:"40"}}),a("div",[a("div",{staticClass:"auth-detail-title"},[t._v(" "+t._s(t.$t("authAquire"))+" ")]),a("div",{staticClass:"auth-detail-sub-title"},[t._v(" "+t._s(t.$t("aquireInfo"))+" ")])])],1)]),a("Row",{staticClass:"button-confirm"},[a("Button",{attrs:{type:"primary",size:"large",loading:t.loading,long:""},on:{click:t.confirm}},[t.loading?a("span",[t._v(t._s(t.$t("authorizing")))]):a("span",[t._v(t._s(t.$t("authorize")))])])],1),a("Row",{staticClass:"to-wrap"},[a("div",[t._v(t._s(t.$t("afterAuth")))]),a("div",{staticClass:"to-strong"},[t._v(t._s(t.site.homeUri))])])],1)])],1),t.error&&!t.authLoading?a("div",{staticStyle:{"margin-top":"15vh"}},[a("Alert",{attrs:{type:"error","show-icon":""}},[t._v(" "+t._s(t.title)+" "),a("span",{attrs:{slot:"desc"},slot:"desc"},[t._v(t._s(t.msg))])])],1):t._e(),t.authLoading?a("div",[a("RectLoading")],1):t._e()]),a("Footer")],1),a("LangSwitch")],1)],1)},i=[],r=s("be65"),o=s.n(r),n=s("365c"),c=s("7f80"),l=function(t,e){return Object(c["a"])("/oauth2/info/"+t,e)},u=function(t){return Object(c["d"])("/oauth2/authorize",t)},d=function(t){return Object(c["e"])("/oauth2/authorized",t)},h=s("c9d5"),f=s("ab7e"),g=s("8d45"),p={components:{LangSwitch:f["default"],Footer:h["default"],RectLoading:g["default"]},data:function(){return{authLoading:!1,title:"",msg:"",error:!1,loadingCaptcha:!0,captchaImg:"",loading:!1,userInfo:{},site:{name:"",homeUri:"",logo:"",autoApprove:!1},form:{username:"admin",password:"123456",code:"",client_id:"111",redirect_uri:"/",state:"",response_type:"",captchaId:this.captchaId},rules:{username:[{required:!0,message:"账号不能为空",trigger:"change"}],password:[{required:!0,message:"密码不能为空",trigger:"change"}],code:[{required:!0,message:"验证码不能为空",trigger:"change"}]}}},methods:{init:function(){var t=this.$route.query;return t.client_id?t.redirect_uri?t.state?(this.form.client_id=t.client_id,this.form.redirect_uri=t.redirect_uri,this.form.state=t.state,this.form.responseType=t.responseType,void this.getSiteInfo(this.form.client_id)):(this.title="参数state非法",this.msg="The parameter state is illegal.",void(this.error=!0)):(this.title="参数redirect_uri非法",this.msg="The parameter redirect_uri is illegal.",void(this.error=!0)):(this.title="参数client_id非法",this.msg="The parameter client_id is illegal.",void(this.error=!0))},getSiteInfo:function(t){var e=this;l(t).then((function(t){t.success?(e.site=t.result,e.isAuthed()):(e.error=!0,e.title=t.message,e.authLoading=!1)}))},isAuthed:function(){var t=this,e=o.a.get("userInfo");this.userInfo=e,e?(this.userInfo=JSON.parse(e),this.site.autoApprove?d(this.form).then((function(e){if(e.success){var s=e.result.redirect_uri+"?code="+e.result.code+"&state="+e.result.state;window.location.href=s}else t.authLoading=!1})):this.authLoading=!1):this.authLoading=!1},confirm:function(){var t=this;this.loading=!0,d(this.form).then((function(e){if(t.loading=!1,e.success){var s=e.result.redirect_uri+"?code="+e.result.code+"&state="+e.result.state;window.location.href=s}}))},getCaptchaImg:function(){var t=this;this.loadingCaptcha=!0,Object(n["Lb"])().then((function(e){t.loadingCaptcha=!1,e.success&&(t.form.captchaId=e.result,t.captchaImg=n["G"]+e.result)}))},submit:function(){var t=this;this.$refs.loginForm.validate((function(e){e&&(t.loading=!0,u(t.form).then((function(e){if(e.success){t.setStore("accessToken",e.result.accessToken);var s=e.result;Object(n["sc"])().then((function(e){if(e.success){delete e.result.permissions;var a=[];e.result.roles.forEach((function(t){a.push(t.name)})),t.setStore("roles",a),o.a.set("userInfo",JSON.stringify(e.result),{expires:7}),t.setStore("userInfo",e.result),t.$store.commit("setUserInfo",e.result);var i=s.redirect_uri+"?code="+s.code+"&state="+s.state;window.location.href=i}else t.loading=!1,t.getCaptchaImg()}))}else t.loading=!1,t.getCaptchaImg()})))}))}},mounted:function(){this.init(),this.getCaptchaImg()}},m=p,v=(s("d659"),s("2877")),_=Object(v["a"])(m,a,i,!1,null,null,null);e["default"]=_.exports},"8ab0":function(t,e,s){},"8d45":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"spinner"},[s("div",{staticClass:"rect1"}),s("div",{staticClass:"rect2"}),s("div",{staticClass:"rect3"}),s("div",{staticClass:"rect4"}),s("div",{staticClass:"rect5"})])}],r={name:"rectLoading"},o=r,n=(s("958a"),s("2877")),c=Object(n["a"])(o,a,i,!1,null,null,null);e["default"]=c.exports},"958a":function(t,e,s){"use strict";s("e699")},ab7e:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"lang-icon"},[a("Dropdown",{attrs:{transfer:""},on:{"on-click":t.langChange}},[a("Icon",{attrs:{type:"md-globe",size:"26"}}),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",{attrs:{name:"zh-CN",selected:"zh-CN"==t.currLang}},[a("div",{staticClass:"lan-logo-content"},[a("img",{staticClass:"country-logo",attrs:{src:s("6336")}}),t._v("简体中文 ")])]),a("DropdownItem",{attrs:{name:"en-US",selected:"en-US"==t.currLang}},[a("div",{staticClass:"lan-logo-content"},[a("img",{staticClass:"country-logo",attrs:{src:s("38f6")}}),t._v("English ")])])],1)],1)],1)},i=[],r={name:"langSwitch",data:function(){return{currLang:"zh-CN"}},methods:{langChange:function(t){this.currLang=t,this.$i18n.locale=t,this.$store.commit("switchLang",t)}},mounted:function(){localStorage.lang&&(this.currLang=localStorage.lang)}},o=r,n=(s("fac3"),s("2877")),c=Object(n["a"])(o,a,i,!1,null,null,null);e["default"]=c.exports},c9d5:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"foot"},[s("Row",{staticClass:"foot-item",attrs:{type:"flex",justify:"space-around"}},[s("a",{staticClass:"item",attrs:{href:"https://www.kancloud.cn/zwz/xboot/1009234",target:"_blank"}},[t._v(t._s(t.$t("docs")))]),s("a",{staticClass:"item",attrs:{href:"https://github.com/zwz/x-boot",target:"_blank"}},[s("Icon",{attrs:{custom:"iconfont icon-github",size:"16"}})],1),s("a",{staticClass:"item",attrs:{href:"http://xpay.zwz.cn/pay?xboot",target:"_blank"}},[t._v(t._s(t.$t("fullVersion")))])]),s("Row",{staticClass:"copyright",attrs:{type:"flex",justify:"center"}},[t._v(" Copyright © 2018 - Present "),s("a",{staticStyle:{margin:"0 5px"},attrs:{href:"http://zwz.cn",target:"_blank"}},[t._v("zwz")]),t._v(" "+t._s(t.$t("rights"))+" ")])],1)},i=[],r={name:"xboot-footer"},o=r,n=(s("e400"),s("2877")),c=Object(n["a"])(o,a,i,!1,null,null,null);e["default"]=c.exports},d659:function(t,e,s){"use strict";s("3e05")},e400:function(t,e,s){"use strict";s("3988")},e699:function(t,e,s){},fac3:function(t,e,s){"use strict";s("8ab0")}}]);